FROM malirod/cpp-dev-base

ENV HOME /root
ENV PROJECT_ROOT $HOME/project
ENV PATH $NINJA_ROOT:$PATH

# Make parallel make build by default
ENV MAKEFLAGS "-j$(nproc) $MAKEFLAGS"

ADD . $PROJECT_ROOT

WORKDIR $PROJECT_ROOT

# Setup dependencies
RUN mkdir build-clang-debug && cd build-clang-debug && CXX=clang cmake ..
RUN mkdir build-clang-release && cd build-clang-release && CXX=clang cmake ..
RUN mkdir build-gcc-debug && cd build-gcc-debug && CXX=g++ cmake ..
RUN mkdir build-gcc-release && cd build-gcc-release && CXX=g++ cmake ..
